## HTTP 1.1
- 优化
  - 增加持久连接的方法，在一个TCP连接上持续传输多个HTTP请求，避免每次请求都需要耗费时间进行TCP的三次握手与四次挥手。
  - 每个域名可建立6个 TCP 持久连接，并发请求数据。
  - 引入 Cookie 机制，来改善 HTTP 无状态的问题。
  - 提供 Host 请求头，用来表示当前域名地址，以此提供对虚拟主机的支持。
- 缺点
  - 宽带利用率低。
  - TCP 慢启动问题，导致耗费时间比正常请求时间要多，推迟了页面渲染时长。
  - 多个 TCP 持久连接，会竞争固定宽带。有的 TCP 下载的是关键资源，但是多条 TCP 之间无法协商哪个 TCP 先下载，宽带不足导致 TCP 传输速度降低，影响资源下载。
  - 队头阻塞问题，一个 TCP 连接只能串行进行请求的处理，当某个请求阻塞时，后续请求都处于排队状态，浪费资源。

## HTTP 2
- 优化
  - 一个域名只使用一个 TCP 长连接来传输数据，这样整个页面资源的下载过程只需要一次慢启动，同时也避免了多个 TCP 连接竞争带宽所带来的问题。
  - 实现资源的并行请求，任何时候都可以将请求发送给服务器，而并不需要等待其他请求的完成。
  - 这叫做 多路复用 技术。 HTTP 2 中最核心的优化功能。
  - 设置请求的优先级，请求优先处理。
  - 服务端推送。
  - 头部压缩。

- 多路复用实现原理
  - 采用二进制分帧层，将请求信息转换为带有请求ID的帧，然后将该帧发送至服务器。
  - 服务器收到所有的帧后进行组装解析为一个完整的请求信息。
  - 处理请求返回对应的响应信息
  - 响应信息也会经过二进制分帧层转换为带有请求ID编号的帧，然后发送至浏览器端。
  - 浏览器接受后，根据请求ID编号，将对应的帧的数据提交给对应的请求。

- 缺陷
  - HTTP2 解决了应用层面的队头阻塞问题，但是TCP的队头阻塞还是依旧存在的。并且此时阻塞的时后续所有的请求，因为现在只有一个TCP连接
  - TCP 建立连接的三次握手 以及 HTTPS 的 TLS 连接存在耗时。
  - TCP 协议僵化，难以修改，因为所有的中间设备都是基于TCP开发的，TCP 是基于操作系统开发的，应用程序只能使用不同修改。

## HTTP3
- QUIC 协议
  - 基于 UDP 实现的类似于 TCP 的多路数据流、传输可靠性等功能。
  - 实现了类似 TCP 的流量控制、传输可靠性的功能。虽然 UDP 不提供可靠性的传输，但 QUIC 在 UDP 的基础之上增加了一层来保证数据可靠性传输。它提供了数据包重传、拥塞控制以及其他一些 TCP 中存在的特性。
  - 集成了 TLS 加密功能。目前 QUIC 使用的是 TLS1.3，相较于早期版本 TLS1.3 有更多的优点，其中最重要的一点是减少了握手所花费的 RTT 个数。
  - 实现了 HTTP/2 中的多路复用功能。和 TCP 不同，QUIC 实现了在同一物理连接上可以有多个独立的逻辑数据流。实现了数据流的单独传输，就解决了 TCP 中队头阻塞的问题。
- 面对的挑战
  - 服务器和浏览器端都没有对 HTTP/3 提供比较完整的支持。
  - 系统内核对 UDP 的优化远远没有达到 TCP 的优化程度，这也是阻碍 QUIC 的一个重要原因。
  - 中间设备僵化的问题。这些设备对 UDP 的优化程度远远低于 TCP。