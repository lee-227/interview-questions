## 介绍
- HTTP是一种允许浏览器向服务器获取资源的协议。
- 是建立在TCP连接基础之上的。

## 与 TCP 的关系
- 浏览器使用HTTP协议作为应用层协议，用来封装请求的文本信息；并使用TCP/IP作传输层协议将它发到网络上

## 浏览器发起 HTTP 请求流程
1. 首先交给网络进程，进行资源的获取
2. 查找缓存，先在浏览器缓存中查询是否有要请求的文件，浏览器缓存中存有副本，它会拦截请求，返回该资源的副本，并直接结束请求，而不会再去源服务器重新下载。
   1. 缓解服务器端压力，提升性能（获取资源的耗时更短了）；
   2. 对于网站来说，缓存是实现快速资源加载的重要组成部分。
3. 准备IP地址和端口
   1. 通过域名解析，获取目的主机 IP
   2. 缓存解析结果
   3. 通过 URL 获取端口，默认 80
4. 等待TCP队列
   1. Chrome有个机制，同一个域名同时最多只能建立6个TCP连接，如果在同一个域名下同时有10个请求发生，那么其中4个请求会进入排队等待状态，直至进行中的请求完成。
5. 建立TCP连接
   1. 三次握手的目的是为了防止已经失效的连接请求突然又传送到服务端，因而产生错误。
   2. 第一次握手：建立连接。客户端发送连接请求报文段，将SYN位置为1，Sequence Number为x；然后，客户端进入SYN_SEND状态，等待服务器的确认；
   3. 第二次握手：服务器收到SYN报文段。服务器收到客户端的SYN报文段，需要对这个SYN报文段进行确认，设置Acknowledgment Number为x+1(Sequence Number+1)；同时，自己还要发送SYN请求信息，将SYN位置为1，Sequence Number为y；服务器端将上述所有信息放到一个报文段（即SYN+ACK报文段）中，一并发送给客户端，此时服务器进入SYN_RECV状态；
   4. 第三次握手：客户端收到服务器的SYN+ACK报文段。然后将Acknowledgment Number设置为y+1，向服务器发送ACK报文段，这个报文段发送完毕以后，客户端和服务器端都进入ESTABLISHED状态，完成TCP三次握手。  
6. 发送HTTP请求
   1. 首先浏览器会向服务器发送请求行，它包括了请求方法、请求URI（Uniform Resource Identifier）和HTTP版本协议。
   2. 在浏览器发送请求行命令之后，还要以请求头形式发送其他一些信息，比如当前请求的域名信息、浏览器端的Cookie信息，等等。
7. 服务器端处理HTTP请求流程
   1. 首先服务器会返回响应行，包括协议版本和状态码。
      1. 重定向，响应行返回的状态码是301，接下来，浏览器获取Location字段中的地址，并使用该地址重新导航。
   2. 也会随同响应向浏览器发送响应头。响应头包含了服务器自身的一些信息，比如服务器生成返回数据的时间、返回的数据类型（JSON、HTML、流媒体等类型），以及服务器要在客户端保存的Cookie等信息。
   3. 发送完响应头后，服务器就可以继续发送响应体的数据，通常，响应体就包含了HTML的实际内容。
8. 断开连接
   1. 通常情况下，一旦服务器向客户端返回了请求数据，它就要关闭 TCP 连接。
   2. 如果浏览器或者服务器在其头信息中加入了Connection:Keep-Alive，那么TCP连接在发送后将仍然保持打开状态，这样浏览器就可以继续通过同一个TCP连接发送请求。保持TCP连接可以省去下次请求时需要建立连接的时间，提升资源加载速度。